// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Customer {
  id           Int           @id @default(autoincrement())
  name         String
  phone        String        @unique
  nationalCode String
  desc         String?
  Order        Order[]
  Transaction  Transaction[]
}

model Order {
  id             Int           @id @default(autoincrement())
  amount         Int
  desc           String        @default("")
  chequeStatus   String        @default("not-checked")
  needPayment    Boolean       @default(false)
  timeRegistered Int
  customerId     Int
  Customer       Customer      @relation(fields: [customerId], references: [id], onDelete: NoAction)
  Transaction    Transaction[]
}

model Transaction {
  id          Int      @id @default(autoincrement())
  timeCreated Int
  valuePaid   Int
  verified    Boolean  @default(false)
  successful  Boolean  @default(false)
  payId       String
  payPortal   String
  payTime     Int
  orderId     Int
  customerId  Int
  Customer    Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  Order       Order    @relation(fields: [orderId], references: [id], onDelete: NoAction)
}

model AppConfig {
  id                           Int     @id @default(autoincrement())
  doSendSmsToManager           Boolean @default(false)
  managerPhoneNum              String  @default("")
  doSendMessageToManagerInBale Boolean @default(false)
  mangerBaleId                 String  @default("")
  appName                      String  @default("")
  appLogoPath                  String  @default("")
  ticketTermsAndServices       String  @default("")
  appTestMode                  Boolean @default(false)
  paymentPortalMerchantId      String  @default("")
  payValue                     Int     @default(0)
  payNeeded                    Boolean @default(false)
}

model AdminUser {
  id       Int    @id @default(autoincrement())
  username String @unique
  password String
}
